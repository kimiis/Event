{% extends 'base.html.twig' %}
{% block title %}
    <h1>Liste of events</h1>
{% endblock %}

{% block body %}
    <div class="content">
        <p> page liste </p>

        {% for event in events %}
            <li>
                <a href="{{ path('_detail',  {'event': event.id}) }}"> Name : {{ event.title }}
                    Place : {{ event.users.count }}/{{  event.nbMaxInsc }} ,
                    Status : {{ event.status.name }}, Date of the event {{ event.dateD| date('Y-m-d h:m') }}
                    Registered?
                    Actions:
                    Date limit : {{ event.limiteDate |  date('Y-m-d h:m') }}
                </a>

                {% if event.dateD > "now" | date('Y-m-d') and event.status.name is same as ("Open") and event.organizer is not same as (user) %}

                    {% if event.Users.contains(user) %}

                        <a href="{{ path('_unRegisterForEvent', {'event': event.id}) }}">
                            <input type="button" value="Unsubscribe to event"></a>

                    {% endif %}

                    {% if event.NbMaxInsc > event.Users.count and not event.Users.contains(user) and event.LimiteDate > "now"| date('Y-m-d') %}

                        <a href="{{ path('_registerForEvent', {'event': event.id}) }}">
                            <input type="button" value="Subscribe to event"></a>
                    {% endif %}

                {% endif %}

                {#                <a href="{{ path('_registerForEvent', {'event': event.id}) }}"> #}
                {#                    <input type="button" #}
                {#                           value="{% if not event.Users.contains(user) %} Subscribe to event {% else %} Unsubscribe to event {% endif %}"> #}
                {#                </a> #}

                {% if event.organizer is same as (user) and event.status.name is same as ("Open") %}
{#                    <a href="{{ path('app_eventCanceled', {'event': event.id}) }}">#}
                        <input name="{{ event.id }}" type="button" value="Cancel event" id="cancelButton">
{#                    </a>#}
                {% endif %}

                </li>
        {% endfor %}
    </div>
{% endblock %}
